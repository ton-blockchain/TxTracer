import{r as c,R as B,v as je,d as N,j as A}from"./Badge-syZ0e9Xk.js";import{a as Le}from"./monaco-editor-core-BNZEfIW9.js";import{E as Ae}from"./error-codes-B36bHDJL.js";import"./ton-vendor-BkcVSvwD.js";import"./ton-assembly-nn7KYO_c.js";import"./ton-sandbox-uER9kMRK.js";function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){Ie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Ne(e,t){if(e==null)return{};var r=Pe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xe(e,t){return $e(e)||Fe(e,t)||De(e,t)||ze()}function $e(e){if(Array.isArray(e))return e}function Fe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,i=void 0;try{for(var s=e[Symbol.iterator](),a;!(n=(a=s.next()).done)&&(r.push(a.value),!(t&&r.length===t));n=!0);}catch(p){o=!0,i=p}finally{try{!n&&s.return!=null&&s.return()}finally{if(o)throw i}}return r}}function De(e,t){if(e){if(typeof e=="string")return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,t)}}function pe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Be(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?me(Object(r),!0).forEach(function(n){Be(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function We(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(o,i){return i(o)},n)}}function U(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var s=arguments.length,a=new Array(s),p=0;p<s;p++)a[p]=arguments[p];return t.apply(r,[].concat(o,a))}}}function te(e){return{}.toString.call(e).includes("Object")}function Re(e){return!Object.keys(e).length}function G(e){return typeof e=="function"}function He(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ze(e,t){return te(t)||D("changeType"),Object.keys(t).some(function(r){return!He(e,r)})&&D("changeField"),t}function Ke(e){G(e)||D("selectorType")}function Ue(e){G(e)||te(e)||D("handlerType"),te(e)&&Object.values(e).some(function(t){return!G(t)})&&D("handlersType")}function Ve(e){e||D("initialIsRequired"),te(e)||D("initialType"),Re(e)&&D("initialContent")}function Ge(e,t){throw new Error(e[t]||e.default)}var qe={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},D=U(Ge)(qe),Y={changes:Ze,selector:Ke,handler:Ue,initial:Ve};function Xe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Y.initial(e),Y.handler(t);var r={current:e},n=U(Qe)(r,t),o=U(Ye)(r),i=U(Y.changes)(e),s=U(Je)(r);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(l){return l};return Y.selector(u),u(r.current)}function p(u){We(n,o,i,s)(u)}return[a,p]}function Je(e,t){return G(t)?t(e.current):t}function Ye(e,t){return e.current=ge(ge({},e.current),t),t}function Qe(e,t,r){return G(t)?t(e.current):Object.keys(r).forEach(function(n){var o;return(o=t[n])===null||o===void 0?void 0:o.call(t,e.current[n])}),r}var et={create:Xe},tt={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function rt(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.length>=e.length?e.apply(this,o):function(){for(var s=arguments.length,a=new Array(s),p=0;p<s;p++)a[p]=arguments[p];return t.apply(r,[].concat(o,a))}}}function nt(e){return{}.toString.call(e).includes("Object")}function ot(e){return e||he("configIsRequired"),nt(e)||he("configType"),e.urls?(it(),{paths:{vs:e.urls.monacoBase}}):e}function it(){console.warn(we.deprecation)}function st(e,t){throw new Error(e[t]||e.default)}var we={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},he=rt(st)(we),at={config:ot},ct=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(o){return r.reduceRight(function(i,s){return s(i)},o)}};function Ce(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],Ce(e[r],t[r]))}),fe(fe({},e),t)}var ut={type:"cancelation",msg:"operation is manually canceled"};function ie(e){var t=!1,r=new Promise(function(n,o){e.then(function(i){return t?o(ut):n(i)}),e.catch(o)});return r.cancel=function(){return t=!0},r}var lt=et.create({config:tt,isInitialized:!1,resolve:null,reject:null,monaco:null}),Ee=xe(lt,2),X=Ee[0],re=Ee[1];function dt(e){var t=at.config(e),r=t.monaco,n=Ne(t,["monaco"]);re(function(o){return{config:Ce(o.config,n),monaco:r}})}function ft(){var e=X(function(t){var r=t.monaco,n=t.isInitialized,o=t.resolve;return{monaco:r,isInitialized:n,resolve:o}});if(!e.isInitialized){if(re({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),ie(se);if(window.monaco&&window.monaco.editor)return Me(window.monaco),e.resolve(window.monaco),ie(se);ct(pt,gt)(ht)}return ie(se)}function pt(e){return document.body.appendChild(e)}function mt(e){var t=document.createElement("script");return e&&(t.src=e),t}function gt(e){var t=X(function(n){var o=n.config,i=n.reject;return{config:o,reject:i}}),r=mt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function ht(){var e=X(function(r){var n=r.config,o=r.resolve,i=r.reject;return{config:n,resolve:o,reject:i}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){Me(r),e.resolve(r)},function(r){e.reject(r)})}function Me(e){X().monaco||re({monaco:e})}function vt(){return X(function(e){var t=e.monaco;return t})}var se=new Promise(function(e,t){return re({resolve:e,reject:t})}),q={config:dt,init:ft,__getMonacoInstance:vt},bt={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ae=bt,yt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},kt=yt;function wt({children:e}){return B.createElement("div",{style:kt.container},e)}var Ct=wt,Et=Ct;function Mt({width:e,height:t,isEditorReady:r,loading:n,_ref:o,className:i,wrapperProps:s}){return B.createElement("section",{style:{...ae.wrapper,width:e,height:t},...s},!r&&B.createElement(Et,null,n),B.createElement("div",{ref:o,style:{...ae.fullWidth,...!r&&ae.hide},className:i}))}var Tt=Mt,Te=c.memo(Tt);function _t(e){c.useEffect(e,[])}var ue=_t;function Ot(e,t,r=!0){let n=c.useRef(!0);c.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var L=Ot;function V(){}function H(e,t,r,n){return St(e,n)||jt(e,t,r,n)}function St(e,t){return e.editor.getModel(_e(e,t))}function jt(e,t,r,n){return e.editor.createModel(t,r,n?_e(e,n):void 0)}function _e(e,t){return e.Uri.parse(t)}function Lt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:o,originalModelPath:i,modifiedModelPath:s,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:p=!1,theme:u="light",loading:l="Loading...",options:d={},height:m="100%",width:f="100%",className:b,wrapperProps:w={},beforeMount:T=V,onMount:v=V}){let[C,x]=c.useState(!1),[I,h]=c.useState(!0),k=c.useRef(null),E=c.useRef(null),P=c.useRef(null),_=c.useRef(v),g=c.useRef(T),$=c.useRef(!1);ue(()=>{let y=q.init();return y.then(M=>(E.current=M)&&h(!1)).catch(M=>M?.type!=="cancelation"&&console.error("Monaco initialization: error:",M)),()=>k.current?j():y.cancel()}),L(()=>{if(k.current&&E.current){let y=k.current.getOriginalEditor(),M=H(E.current,e||"",n||r||"text",i||"");M!==y.getModel()&&y.setModel(M)}},[i],C),L(()=>{if(k.current&&E.current){let y=k.current.getModifiedEditor(),M=H(E.current,t||"",o||r||"text",s||"");M!==y.getModel()&&y.setModel(M)}},[s],C),L(()=>{let y=k.current.getModifiedEditor();y.getOption(E.current.editor.EditorOption.readOnly)?y.setValue(t||""):t!==y.getValue()&&(y.executeEdits("",[{range:y.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),y.pushUndoStop())},[t],C),L(()=>{k.current?.getModel()?.original.setValue(e||"")},[e],C),L(()=>{let{original:y,modified:M}=k.current.getModel();E.current.editor.setModelLanguage(y,n||r||"text"),E.current.editor.setModelLanguage(M,o||r||"text")},[r,n,o],C),L(()=>{E.current?.editor.setTheme(u)},[u],C),L(()=>{k.current?.updateOptions(d)},[d],C);let z=c.useCallback(()=>{if(!E.current)return;g.current(E.current);let y=H(E.current,e||"",n||r||"text",i||""),M=H(E.current,t||"",o||r||"text",s||"");k.current?.setModel({original:y,modified:M})},[r,t,o,e,n,i,s]),R=c.useCallback(()=>{!$.current&&P.current&&(k.current=E.current.editor.createDiffEditor(P.current,{automaticLayout:!0,...d}),z(),E.current?.editor.setTheme(u),x(!0),$.current=!0)},[d,u,z]);c.useEffect(()=>{C&&_.current(k.current,E.current)},[C]),c.useEffect(()=>{!I&&!C&&R()},[I,C,R]);function j(){let y=k.current?.getModel();a||y?.original?.dispose(),p||y?.modified?.dispose(),k.current?.dispose()}return B.createElement(Te,{width:f,height:m,isEditorReady:C,loading:l,_ref:P,className:b,wrapperProps:w})}var At=Lt;c.memo(At);function It(){let[e,t]=c.useState(q.__getMonacoInstance());return ue(()=>{let r;return e||(r=q.init(),r.then(n=>{t(n)})),()=>r?.cancel()}),e}var Pt=It;function Nt(e){let t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}var xt=Nt,Q=new Map;function $t({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:o,path:i,theme:s="light",line:a,loading:p="Loading...",options:u={},overrideServices:l={},saveViewState:d=!0,keepCurrentModel:m=!1,width:f="100%",height:b="100%",className:w,wrapperProps:T={},beforeMount:v=V,onMount:C=V,onChange:x,onValidate:I=V}){let[h,k]=c.useState(!1),[E,P]=c.useState(!0),_=c.useRef(null),g=c.useRef(null),$=c.useRef(null),z=c.useRef(C),R=c.useRef(v),j=c.useRef(),y=c.useRef(n),M=xt(i),J=c.useRef(!1),S=c.useRef(!1);ue(()=>{let O=q.init();return O.then(F=>(_.current=F)&&P(!1)).catch(F=>F?.type!=="cancelation"&&console.error("Monaco initialization: error:",F)),()=>g.current?Se():O.cancel()}),L(()=>{let O=H(_.current,e||n||"",t||o||"",i||r||"");O!==g.current?.getModel()&&(d&&Q.set(M,g.current?.saveViewState()),g.current?.setModel(O),d&&g.current?.restoreViewState(Q.get(i)))},[i],h),L(()=>{g.current?.updateOptions(u)},[u],h),L(()=>{!g.current||n===void 0||(g.current.getOption(_.current.editor.EditorOption.readOnly)?g.current.setValue(n):n!==g.current.getValue()&&(S.current=!0,g.current.executeEdits("",[{range:g.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),g.current.pushUndoStop(),S.current=!1))},[n],h),L(()=>{let O=g.current?.getModel();O&&o&&_.current?.editor.setModelLanguage(O,o)},[o],h),L(()=>{a!==void 0&&g.current?.revealLine(a)},[a],h),L(()=>{_.current?.editor.setTheme(s)},[s],h);let K=c.useCallback(()=>{if(!(!$.current||!_.current)&&!J.current){R.current(_.current);let O=i||r,F=H(_.current,n||e||"",t||o||"",O||"");g.current=_.current?.editor.create($.current,{model:F,automaticLayout:!0,...u},l),d&&g.current.restoreViewState(Q.get(O)),_.current.editor.setTheme(s),a!==void 0&&g.current.revealLine(a),k(!0),J.current=!0}},[e,t,r,n,o,i,u,l,d,s,a]);c.useEffect(()=>{h&&z.current(g.current,_.current)},[h]),c.useEffect(()=>{!E&&!h&&K()},[E,h,K]),y.current=n,c.useEffect(()=>{h&&x&&(j.current?.dispose(),j.current=g.current?.onDidChangeModelContent(O=>{S.current||x(g.current.getValue(),O)}))},[h,x]),c.useEffect(()=>{if(h){let O=_.current.editor.onDidChangeMarkers(F=>{let ne=g.current.getModel()?.uri;if(ne&&F.find(oe=>oe.path===ne.path)){let oe=_.current.editor.getModelMarkers({resource:ne});I?.(oe)}});return()=>{O?.dispose()}}return()=>{}},[h,I]);function Se(){j.current?.dispose(),m?d&&Q.set(i,g.current.saveViewState()):g.current.getModel()?.dispose(),g.current.dispose()}return B.createElement(Te,{width:f,height:b,isEditorReady:h,loading:p,_ref:$,className:w,wrapperProps:T})}var Ft=$t,Dt=c.memo(Ft),zt=Dt;function Bt(e){return new Worker(""+new URL("editor.worker-B05KjEa_.js",import.meta.url).href,{name:e?.name})}const Wt=({monaco:e,editorRef:t,markers:r=[],enabled:n})=>{c.useEffect(()=>{if(!e||!t.current||!n)return;const o=t.current.getModel();if(o)return e.editor.setModelMarkers(o,"Tolk",[...r]),()=>{e.editor.setModelMarkers(o,"Tolk",[])}},[e,r,t,n])};let Z=null,ce=!1,ve=!1;async function Rt(){if(Z)return Z;if(ce)return null;ce=!0;try{const e=await fetch("/assets/asm/asm.json");return e.ok?(Z=await e.json(),Z):(console.error("Failed to fetch asm.json:",e.statusText),null)}catch(e){return console.error("Error fetching or parsing asm.json:",e),null}finally{ce=!1}}function le(){if(Z)return Z;ve||(ve=!0,Rt())}function Ht(e){const t=le();if(t===void 0)return;const r=Zt(e),n=t?.instructions.find(i=>i.mnemonic===r);if(n)return n;const o=t?.aliases.find(i=>i.mnemonic===e);if(o){const i=t?.instructions.find(s=>s.mnemonic===o.alias_of);if(i)return{...i,alias_info:o}}return null}function Zt(e){return e==="PUSHINT"?"PUSHINT_4":e==="XCHG0"?"XCHG_0I":e==="XCHG"?"XCHG_IJ":e}function be(e){if(!e)return"";const t=e.trim(),r=t.startsWith("-")?"∅ ":"",n=t.endsWith("-")?" ∅":"";return`(${r+e.replace("-","→")+n})`}function Kt(e){return Object.entries(e).map(([t,r])=>r?.toString()??"").join(" ")}function Ut(e){const t=e.doc.stack?`- Stack (top is on the right): \`${be(e.doc.stack)}\``:"",r=e.doc.gas.length>0?e.doc.gas:"unknown",n=["```",e.mnemonic,"```",t,`- Gas: \`${r}\``,`- Opcode: \`${e.doc.opcode}\``,"",e.doc.description,"",""];if(e.alias_info){const i=` alias of ${Kt(e.alias_info.operands)+" "}${e.alias_info.alias_of}`,s=e.alias_info,a=s.doc_stack?`- Stack (top is on the right): \`${be(s.doc_stack)}\``:"";return["```",s.mnemonic+i,"```",a,"",s.description??"","","---","","Aliased instruction info:","",...n].join(`
`)}return n.join(`
`)}const Vt={base:"vs",inherit:!0,rules:[{token:"keyword",foreground:"#0033B3",fontStyle:"bold"},{token:"string",foreground:"#067D17"},{token:"string.number",foreground:"#1750EB"},{token:"string.slice",foreground:"#1750EB"},{token:"string.asm",foreground:"#067D17",fontStyle:"italic"},{token:"number",foreground:"#1750EB"},{token:"number.hex",foreground:"#1750EB"},{token:"number.version",foreground:"#1750EB"},{token:"comment",foreground:"#8C8C8C",fontStyle:"italic"},{token:"annotation",foreground:"#9E880D"},{token:"keyword.directive",foreground:"#9C5D27"},{token:"identifier.function",foreground:"#795E26"},{token:"identifier.field",foreground:"#001080"},{token:"identifier.constant",foreground:"#871094",fontStyle:"bold"},{token:"identifier.special",foreground:"#795E26",fontStyle:"bold"},{token:"identifier.backtick",foreground:"#000000"},{token:"keyword.underscore",foreground:"#0033B3"},{token:"operator",foreground:"#000000"},{token:"instruction",foreground:"#0033B3"}],colors:{"editorInlayHint.typeForeground":"#7e6820","editorInlayHint.typeBackground":"#fff3cd"}},Gt={base:"vs-dark",inherit:!0,rules:[{token:"string",foreground:"#CE9178"},{token:"string.number",foreground:"#B5CEA8"},{token:"string.slice",foreground:"#B5CEA8"},{token:"string.asm",foreground:"#CE9178",fontStyle:"italic"},{token:"number",foreground:"#B5CEA8"},{token:"number.hex",foreground:"#B5CEA8"},{token:"number.version",foreground:"#B5CEA8"},{token:"comment",foreground:"#6A9955",fontStyle:"italic"},{token:"annotation",foreground:"#cac46b"},{token:"keyword.directive",foreground:"#C586C0"},{token:"identifier.function",foreground:"#DCDCAA"},{token:"identifier.field",foreground:"#9CDCFE"},{token:"identifier.constant",foreground:"#4FC1FF",fontStyle:"bold"},{token:"identifier.special",foreground:"#DCDCAA",fontStyle:"bold"},{token:"identifier.backtick",foreground:"#D4D4D4"},{token:"keyword.underscore",foreground:"#569CD6"},{token:"operator",foreground:"#D4D4D4"},{token:"instruction",foreground:"#749DED"},{token:"alias",foreground:"#9a9a9a"}],colors:{"editor.background":"#1c1c1e","editorInlayHint.typeForeground":"#FF6B6B","editorInlayHint.typeBackground":"#3A1F1F"}},qt={defaultToken:"invalid",keywords:["forall","return","if","ifnot","else","elseif","elseifnot","repeat","do","until","while","global","const","asm","impure","inline","inline_ref","method_id","type","null","throw","throw_if","throw_unless","true","false","empty_tuple"],typeKeywords:["int","cell","slice","builder","cont","tuple","var"],directives:["#include","#pragma","version","not-version","allow-post-modification","compute-asm-ltr"],operators:["=","+=","-=","*=","/=","~/=","^/=","%=","~%=","^%=","<<=",">>=","~>>=","^>>=","&=","|=","^=","==","!=","<",">","<=",">=","<=>","<<",">>","~>>","^>>","+","-","|","^","*","/","%","~/","^/","~%","^%","/%","&","~",".","?",":","->","=>"],symbols:/[=><!~?:&|+\-*/^%]+/,tokenizer:{root:[[/;;.*$/,"comment"],[/\{-/,{token:"comment",next:"@comment"}],[/"""/,{token:"string.asm",next:"@asmblock"}],[/(#include|#pragma)\b/,"keyword.directive"],[/\b(version|not-version|allow-post-modification|compute-asm-ltr)\b/,"keyword.directive"],[/(>=|<=|=|>|<|\^)?([0-9]+)(.[0-9]+)?(.[0-9]+)?/,"number.version"],[/%[a-zA-Z_][a-zA-Z0-9_]*/,"identifier.function"],[/\$[a-zA-Z_][a-zA-Z0-9_$']*/,"identifier.special"],[/`[^`]+`/,"identifier.backtick"],[/\b[A-Z][A-Z0-9_]*\b/,"identifier.constant"],[/[a-zA-Z_][a-zA-Z0-9_'?]*(?=\()/,"identifier.function"],[/~[a-zA-Z_][a-zA-Z0-9_?]*/,"identifier.function"],[/\.[a-zA-Z_][a-zA-Z0-9_?]*/,"identifier.function"],[/[a-zA-Z_][a-zA-Z0-9_']*/,{cases:{"@keywords":"keyword","@typeKeywords":"type","@default":"identifier"}}],[/-?0x[0-9a-fA-F]+/,"number.hex"],[/-?\d+/,"number"],[/"[^"]*"[Hhcu]/,"string.number"],[/"[^"]*"[sa]/,"string.slice"],[/"[^"]*"/,"string"],[/~/,"operator"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/[{}]/,"@brackets"],[/[[\]]/,"delimiter.square"],[/[()]/,"delimiter.parenthesis"],[/;/,"delimiter"],[/,/,"delimiter"],[/_/,"keyword.underscore"],[/\s+/,"white"]],asmblock:[[/"""/,{token:"string.asm",next:"@pop"}],[/[^"]+/,"string.asm"],[/"/,"string.asm"]],comment:[[/[^-{]+/,"comment"],[/\{-/,{token:"comment",next:"@push"}],[/-\}/,{token:"comment",next:"@pop"}],[/[-{]/,"comment"]]}},Xt={keywords:["ref","embed","exotic","library"],operators:["=>"],tokenizer:{root:[[/\b(ref|embed|exotic|library)\b/,"keyword"],[/\b[A-Z_][A-Z0-9_]*[0-9]?[0-9]?\b/,"instruction"],[/s-?[0-9][0-9]?/,"number.hex"],[/c[0-9][0-9]?/,"number.hex"],[/x\{[0-9a-fA-F_]*}/,"number.hex"],[/b\{[01]*}/,"number.binary"],[/boc\{[0-9a-fA-F]*}/,"number.hex"],[/"([^"\\]|\\.)*"/,"string"],[/-?\d+/,"number"],[/\{/,{token:"delimiter.curly",next:"@push"}],[/}/,{token:"delimiter.curly",next:"@pop"}],[/\[/,{token:"delimiter.square",next:"@push"}],[/]/,{token:"delimiter.square",next:"@pop"}],[/\(\)/,"delimiter.parenthesis"],[/\/\/.*?$/,"comment"],[/\b(alias|of)\b/,"alias"],[/\s+/,"white"]]}},Jt={defaultToken:"invalid",keywords:["tolk","import","global","const","type","struct","fun","get","var","val","return","if","else","while","repeat","do","break","continue","throw","assert","try","catch","match","as","is","lazy","mutate","redef","builtin","asm","true","false","null","self"],typeKeywords:["int","bool","cell","slice","builder","continuation","tuple","address","never","coins","map","void"],operators:["=","+=","-=","*=","/=","%=","<<=",">>=","&=","|=","^=","==","!=","<=",">=","<=>","&&","||","&","|","^","<<",">>","~>>","^>>","-","+","*","/","%","~/","^/","!","~","->","?",":",".","<",">"],symbols:/[=><!~?:&|+\-*/^%()[\]{}.,;]+/,tokenizer:{root:[[/\/\/.*$/,"comment"],[/\/\*/,{token:"comment",next:"@comment"}],[/"""/,{token:"string",next:"@stringTriple"}],[/"(?:[^"\\\n]|\\.)*"/,"string"],[/u?int\d{1,3}/,"type"],[/varu?int\d{1,2}/,"type"],[/((bits)|(bytes))\d{1,3}/,"type"],[/@[a-zA-Z_][a-zA-Z0-9_]*/,"annotation"],[/0x[0-9a-fA-F]+/,"number.hex"],[/0b[01]+/,"number.binary"],[/\d+/,"number"],[/(\d+)(\.\d+)?(\.\d+)?/,"number.version"],[/`[^`]+`/,"identifier.backtick"],[/[a-zA-Z_][a-zA-Z0-9_$]*(?=[(<])/,"identifier.function"],[/\.(?=[A-Za-z_][A-Za-z0-9_]*)/,{token:"delimiter.dot",next:"@member"}],[/[A-Z][a-zA-Z0-9_]*/,"type.identifier"],[/[a-zA-Z$_][a-zA-Z0-9$_]*/,{cases:{"@keywords":"keyword","@typeKeywords":"type","@default":"identifier"}}],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/[{}]/,"@brackets"],[/[[\]]/,"delimiter.square"],[/[()]/,"delimiter.parenthesis"],[/;/,"delimiter"],[/,/,"delimiter"],[/_/,"keyword.underscore"],[/\s+/,"white"]],stringTriple:[[/"""/,{token:"string",next:"@pop"}],[/\\./,"string.escape"],[/[^\\"]+/,"string"],[/"/,"string"]],comment:[[/[^/*]+/,"comment"],[/\/\*/,{token:"comment",next:"@push"}],[/\*\//,{token:"comment",next:"@pop"}],[/[/*]/,"comment"]],member:[[/[A-Za-z_][A-Za-z0-9_]*(?=[(<])/,{token:"identifier.function",next:"@pop"}],[/[A-Za-z_][A-Za-z0-9_]*/,{token:"identifier.field",next:"@pop"}]]}},W="tasm",ye="func",ke="tolk",Yt=(e,t)=>{t==="tasm"&&(e.languages.register({id:W}),e.languages.setMonarchTokensProvider(W,Xt)),t==="func"&&(e.languages.register({id:ye}),e.languages.setMonarchTokensProvider(ye,qt)),t==="tolk"&&(e.languages.register({id:ke}),e.languages.setMonarchTokensProvider(ke,Jt)),e.editor.defineTheme("light-theme",Vt),e.editor.defineTheme("dark-theme",Gt)},Qt=({language:e})=>{const t=Pt(),{theme:r}=je(),[n,o]=c.useState(!1),[i,s]=c.useState(!1);return c.useEffect(()=>{typeof window<"u"&&typeof navigator<"u"&&s(navigator.platform.toUpperCase().indexOf("MAC")>=0)},[]),c.useEffect(()=>{if(t)try{Yt(t,e),o(!0)}catch(a){console.error("Failed to initialize Monaco:",a)}},[t,e]),c.useEffect(()=>{if(!(!t||!n))try{t.editor.setTheme(r==="dark"?"dark-theme":"light-theme")}catch(a){console.error("Failed to set theme:",a)}},[r,t,n]),c.useEffect(()=>{if(n&&e==="tasm")try{le()}catch(a){console.warn("Failed to preload assembly data:",a)}},[n,e]),{monaco:t,isReady:n,isMac:i}},er=(e,t)=>({range:new e.Range(t,1,t,1),options:{isWholeLine:!0,className:"highlighted-line"}}),tr=(e,t,r)=>{const n=[];for(const[o,i]of t.entries())for(const s of i.lines)s>0&&s<=r&&n.push({range:new e.Range(s,1,s,1),options:{isWholeLine:!0,className:i.className||`source-map-group-${o}`,overviewRuler:{color:i.color,position:1}}});return n},rr=(e,t,r)=>{const n=[];for(const o of t)o>0&&o<=r&&n.push({range:new e.Range(o,1,o,1),options:{isWholeLine:!0,className:"source-map-hovered-line"}});return n},nr=(e,t,r)=>{const n=[];for(const o of t)o.line>0&&o.line<=r&&n.push({range:new e.Range(o.line,o.startColumn,o.line,o.endColumn),options:{isWholeLine:!1,className:o.className??"precise-highlight",inlineClassName:o.className??"precise-highlight"}});return n},or=(e,t,r,n,o)=>{const i=[],s=o.getLineCount();for(let a=1;a<=s;a++){if(o.getLineContent(a).trim()==="")continue;const l=t[a]!==void 0;if(l&&r){const d=n===a?"clickable-line ctrl-pressed hovered-line":"clickable-line ctrl-pressed";i.push({range:new e.Range(a,1,a,1),options:{isWholeLine:!0,className:d,linesDecorationsClassName:"clickable-line-decoration"}})}else l||i.push({range:new e.Range(a,1,a,o.getLineLength(a)+1),options:{isWholeLine:!1,inlineClassName:"faded-text"}})}return i},ir=({monaco:e,highlightLine:t,implicitRetLine:r,lineExecutionData:n,highlightGroups:o=[],hoveredLines:i=[],highlightRanges:s=[],isCtrlPressed:a=!1,hoveredLine:p=null,shouldCenter:u=!0})=>{const l=c.useRef([]),d=c.useCallback(f=>{if(!e||!f)return;const b=f.getModel();if(!b)return;const w=b.getLineCount(),T=[];try{if(t!==void 0&&T.push(er(e,t)),r!==void 0){const v=Math.min(Math.max(r+1,1),w);T.push({range:new e.Range(v,1,v,1),options:{isWholeLine:!0,className:"implicit-ret-line"}})}if(T.push(...tr(e,o,w)),T.push(...rr(e,i,w)),T.push(...nr(e,s,w)),n&&Object.keys(n).length>0&&T.push(...or(e,n,a,p,b)),l.current=f.deltaDecorations(l.current,T),u){if(t!==void 0)f.revealLineInCenter(t);else if(r!==void 0){const v=Math.min(Math.max(r+1,1),w);f.revealLineInCenter(v)}}}catch(v){console.error("Failed to update decorations:",v)}},[e,t,o,i,s,n,u,a,p,r]),m=c.useCallback(f=>{if(f)try{l.current=f.deltaDecorations(l.current,[])}catch(b){console.error("Failed to clear decorations:",b)}},[]);return{updateDecorations:d,clearDecorations:m}},sr=({monaco:e,editorRef:t,lineExecutionData:r,onLineClick:n,onLineHover:o,editorReady:i=!0})=>{const[s,a]=c.useState(!1),[p,u]=c.useState(null),l=c.useCallback(f=>{(f.ctrlKey||f.metaKey)&&!s&&a(!0),(f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),f.stopPropagation())},[s]),d=c.useCallback(f=>{!f.ctrlKey&&!f.metaKey&&s&&(a(!1),u(null))},[s]),m=c.useCallback(()=>{s&&(a(!1),u(null))},[s]);return c.useEffect(()=>{if(!t.current||!e||!i)return;const f=t.current.onMouseDown(b=>{if(b.target.type!==e.editor.MouseTargetType.GUTTER_LINE_NUMBERS&&b.event.leftButton&&(b.event.ctrlKey||b.event.metaKey)){const w=b.target.position?.lineNumber;w&&r&&r[w]!==void 0&&n&&n(w)}});return()=>f.dispose()},[t,r,n,e,i]),c.useEffect(()=>{if(!e||!t.current||!i)return;const f=t.current.onMouseMove(T=>{const v=T.target.position?.lineNumber;s&&v&&r&&r[v]!==void 0?u(v):s&&u(null),o&&v&&o(v)}),b=()=>{s&&u(null),o&&o(null)},w=t.current.getDomNode();return w&&w.addEventListener("mouseleave",b),()=>{f.dispose(),w?.removeEventListener("mouseleave",b)}},[e,t,s,r,o,i]),c.useEffect(()=>(document.addEventListener("keydown",l),document.addEventListener("keyup",d),window.addEventListener("blur",m),()=>{document.removeEventListener("keydown",l),document.removeEventListener("keyup",d),window.removeEventListener("blur",m)}),[l,d,m]),{isCtrlPressed:s,hoveredLine:p}},ar=e=>{switch(e){case N.trace.FuncType.INT:return"int";case N.trace.FuncType.CELL:return"cell";case N.trace.FuncType.SLICE:return"slice";case N.trace.FuncType.BUILDER:return"builder";case N.trace.FuncType.CONT:return"cont";case N.trace.FuncType.TUPLE:return"tuple";case N.trace.FuncType.TYPE:return"type";default:return`type(${e})`}},cr=e=>{const t=[];return e&N.trace.FuncVarFlag.IN?"Parameter":e&N.trace.FuncVarFlag.NAMED?"Local variable":e&N.trace.FuncVarFlag.TMP?"Temp variable":t.length>0?t.join(", "):"var"},ur=e=>e.length===0?"No variables in scope":`**Live variables:**

${[...e].reverse().map(r=>{const n=`${cr(r.flags)}`,o=`${r.name}`,i=ar(r.type),s=r.value??"",a=s.length!==0?` = ${s}`:"";return`${n} \`${o}: ${i}\`${a}
`}).join(`
`)}`,lr=({monaco:e,lineExecutionData:t,getVariablesForLine:r,showVariablesDocs:n=!0,showInstructionDocs:o=!0,editorReady:i,enabled:s})=>{c.useEffect(()=>{if(!e||!i||!s)return;const a=e.languages.registerHoverProvider(W,{provideHover(p,u){const l=p.getWordAtPosition(u),d=u.lineNumber,m=[];if(n&&r){const f=r(d);f&&f.length>0&&(m.push({value:ur(f)}),m.push({value:"---"}))}if(l){const f=dr[l.word];f&&m.push({value:`**Control register ${l.word} (${f.type})**

${f.description}`});const b=p.getLineContent(d),w=e.editor.tokenize(b,W)[0];let T="";for(let v=0;v<w.length;v++){const C=w[v],x=C.offset+1,I=v+1<w.length?w[v+1].offset+1:b.length+1;if(u.column>=x&&u.column<I){T=C.type;break}}if(T.includes("instruction")&&o){const v=Ht(l.word);if(v===void 0)m.push({value:"The assembly instructions documentation is loading—please hover over the instruction again."});else if(v){const C=Ut(v);C&&m.push({value:C})}if(t){const C=t[d];m.length>0&&m.push({value:"---"}),C===void 0?m.push({value:"**Not executed**"}):m.push({value:`**Executions:** ${C.executions}`})}}}return m.length>0?{range:l?new e.Range(u.lineNumber,l.startColumn,u.lineNumber,l.endColumn):new e.Range(u.lineNumber,1,u.lineNumber,p.getLineLength(u.lineNumber)+1),contents:m}:null}});return()=>{a.dispose()}},[e,t,r,o,n,s,i])},dr={c0:{type:"Continuation",description:"Stores the next or return continuation, similar to a return address."},c1:{type:"Continuation",description:"Stores the alternative continuation."},c2:{type:"Continuation",description:"Contains the exception handler (continuation)."},c3:{type:"Continuation",description:"Holds the current dictionary (hashmap of function codes) as a continuation."},c4:{type:"Cell",description:"Stores persistent data (contract's data section)."},c5:{type:"Cell",description:"Contains output actions."},c7:{type:"Tuple",description:"Stores temporary data."}},fr=({monaco:e,editorRef:t,exitCode:r,editorReady:n,enabled:o})=>{c.useEffect(()=>{if(!e||!t.current||!n||!o)return;const i=e.languages.registerCodeLensProvider(W,{provideCodeLenses:s=>{if(!r?.info?.loc?.line&&r?.info?.loc?.line!==0)return{lenses:[],dispose:()=>{}};const a=r.info.loc.line+1;if(a<=0||a>s.getLineCount())return{lenses:[],dispose:()=>{}};const p=Ae[r.num],u=r.description&&r.description.trim().length>0?`: ${r.description}`:p?.name?`: ${p.name}`:": Custom error";return{lenses:[{range:new e.Range(a,1,a,1),id:`exitCode-${a}`,command:{id:"noop",title:`⚡ Exit Code: ${r.num}${u}`,tooltip:`Transaction failed with exit code ${r.num}${u}`}}],dispose:()=>{}}},resolveCodeLens:(s,a)=>a});return()=>{i.dispose()}},[e,r,t,n,o])},pr=({monaco:e,editorRef:t,editorReady:r,enabled:n=!0})=>{c.useEffect(()=>{if(!e||!t.current||!r||!n)return;const o=e.languages.registerCompletionItemProvider(W,{triggerCharacters:[],provideCompletionItems(i,s){const a=le();if(!a)return{suggestions:[]};const p=i.getWordUntilPosition(s),u={startLineNumber:s.lineNumber,endLineNumber:s.lineNumber,startColumn:p.startColumn,endColumn:p.endColumn},l=p.word.toUpperCase(),d=[];for(const m of a.instructions)l&&!m.mnemonic.startsWith(l)||d.push({label:m.mnemonic,kind:e.languages.CompletionItemKind.Function,insertText:m.mnemonic+" ",range:u,sortText:`0_${m.mnemonic}`,filterText:m.mnemonic});for(const m of a.aliases)l&&!m.mnemonic.startsWith(l)||d.push({label:m.mnemonic,kind:e.languages.CompletionItemKind.Function,insertText:m.mnemonic,range:u,sortText:`1_${m.mnemonic}`,filterText:m.mnemonic});return{suggestions:d}}});return()=>{o.dispose()}},[e,t,r,n])},mr=({monaco:e,implicitRetLine:t,implicitRetLabel:r,editorRef:n,editorReady:o,enabled:i})=>{c.useEffect(()=>{if(!e||!n.current||!o||!i)return;const s=e.languages.registerInlayHintsProvider(W,{displayName:"TxTracer Inlays",provideInlayHints(a){if(t===void 0)return;const p=Math.min(Math.max(t+1,1),a.getLineCount());if((n.current?.getVisibleRanges()??[]).some(l=>l.containsPosition({lineNumber:p,column:0})))return{hints:[{label:r??"↵ implicit RET",position:{lineNumber:p,column:a.getLineLength(p)+1},kind:e.languages.InlayHintKind.Type,tooltip:"Implicit return from a continuation",paddingLeft:!0,paddingRight:!0}],dispose:()=>{}}}});return()=>{s.dispose()}},[e,t,r,o,i,n])},gr=({monaco:e,editorRef:t,markers:r=[],enabled:n})=>{c.useEffect(()=>{if(!e||!t.current||!n)return;const o=t.current.getModel();if(o)return e.editor.setModelMarkers(o,"FunC",[...r]),()=>{e.editor.setModelMarkers(o,"FunC",[])}},[e,r,t,n])},hr=({monaco:e,editorRef:t,lineExecutionData:r})=>({collapseInactiveBlocks:c.useCallback(()=>{if(!t.current||!e)return;try{t.current.trigger("unfold","editor.unfoldAll",{})}catch{}const o=t.current.getModel();if(!o||!r||Object.keys(r).length===0)return;const i=o.getLineCount(),s=[],a=[],p=[];for(let u=1;u<=i;u++){const l=o.getLineContent(u),d=(l.match(/\{/g)??[]).length,m=(l.match(/}/g)??[]).length;for(let f=0;f<d;f++)p.push(u);for(let f=0;f<m;f++)if(p.length>0){const b=p.pop()??0;a.push({start:b,end:u})}}for(const u of a){let l=!0;for(let d=u.start;d<=u.end;d++){const m=o.getLineContent(d),f=r[d]!==void 0,b=m.trim()==="";if(f&&!b){l=!1;break}}l&&u.start<u.end&&s.push({start:u.start,end:u.end})}setTimeout(()=>{for(const u of s)try{t.current?.trigger("fold","editor.fold",{levels:1,selectionLines:[u.start]})}catch{}},100)},[t,e,r])}),vr="_editorWrapperWithBorderRadius_tz4hs_106 _editorWrapper_tz4hs_98",br="_editorWrapperWithoutBorderRadius_tz4hs_111 _editorWrapper_tz4hs_98",yr="_editorHint_tz4hs_116",kr="_hintDivider_tz4hs_156",ee={editorWrapperWithBorderRadius:vr,editorWrapperWithoutBorderRadius:br,editorHint:yr,hintDivider:kr};q.config({monaco:Le});self.MonacoEnvironment={getWorker(){return new Bt}};const Oe=({code:e,highlightLine:t,implicitRetLine:r,implicitRetLabel:n,lineExecutionData:o,onLineClick:i=()=>{},onLineHover:s,shouldCenter:a=!0,exitCode:p,readOnly:u=!0,onChange:l,language:d="tasm",highlightGroups:m=[],hoveredLines:f=[],highlightRanges:b=[],markers:w=[],needBorderRadius:T=!0,getVariablesForLine:v,showVariablesDocs:C=!0,showInstructionDocs:x=!0,onEditorMount:I})=>{const h=c.useRef(null),[k,E]=c.useState(!1),[P,_]=c.useState(!1),{monaco:g,isMac:$}=Qt({language:d}),{isCtrlPressed:z,hoveredLine:R}=sr({monaco:g,editorRef:h,lineExecutionData:o,onLineClick:i,onLineHover:s,editorReady:k}),{updateDecorations:j}=ir({monaco:g,highlightLine:t,implicitRetLine:r,lineExecutionData:o,highlightGroups:m,hoveredLines:f,highlightRanges:b,isCtrlPressed:z,hoveredLine:R,shouldCenter:a});lr({monaco:g,lineExecutionData:o,getVariablesForLine:v,showVariablesDocs:C,showInstructionDocs:x,editorReady:k,enabled:d==="tasm"}),fr({monaco:g,editorRef:h,exitCode:p,editorReady:k,enabled:d==="tasm"}),pr({monaco:g,editorRef:h,editorReady:k,enabled:d==="tasm"}),mr({monaco:g,implicitRetLine:r,implicitRetLabel:n,editorRef:h,editorReady:k,enabled:d==="tasm"}),gr({monaco:g,editorRef:h,markers:w,enabled:d==="func"}),Wt({monaco:g,editorRef:h,markers:w,enabled:d==="tolk"});const{collapseInactiveBlocks:y}=hr({monaco:g,editorRef:h,lineExecutionData:o}),M=c.useCallback(()=>{P||(_(!0),y())},[y,P]);c.useEffect(()=>{h.current&&(P||(j(h.current),M()))},[o,j,M,P]),c.useEffect(()=>{!k||!h.current||(j(h.current),M())},[k,j,M]),c.useEffect(()=>{h.current&&j(h.current)},[z,j]),c.useEffect(()=>{if(!k||!h.current)return;const S=()=>{h.current?.layout()};return window.addEventListener("resize",S),S(),()=>{window.removeEventListener("resize",S)}},[k]);const J=o&&d==="tasm";return A.jsxs(A.Fragment,{children:[A.jsx("div",{className:T?ee.editorWrapperWithBorderRadius:ee.editorWrapperWithoutBorderRadius,children:A.jsx(zt,{height:"100%",width:"100%",language:d,path:d==="func"?"main.fc":d==="tolk"?"main.tolk":"out.tasm",value:e,options:{minimap:{enabled:!1},readOnly:u,lineNumbers:"on",automaticLayout:!0,scrollBeyondLastLine:!1,wordWrap:"on",fontSize:14,tabSize:4,insertSpaces:!0,detectIndentation:!1,fontFamily:"JetBrains Mono",glyphMargin:!0,folding:!0,foldingStrategy:"auto",stickyScroll:{enabled:!1},scrollbar:{useShadows:!1}},loading:A.jsx(A.Fragment,{}),onMount:S=>{const K=S.getModel();g&&K&&K.setEOL(g.editor.EndOfLineSequence.LF),h.current=S,E(!0),I&&I(S)},onChange:S=>{l!==void 0&&S!==void 0&&l(S),h.current&&j(h.current)}})}),J&&A.jsxs("div",{className:ee.editorHint,children:[A.jsx("kbd",{children:$?"⌘":"Ctrl"})," + ",A.jsx("kbd",{children:"Click"})," to navigate to trace step",A.jsx("span",{className:ee.hintDivider,children:"|"}),A.jsx("kbd",{children:"←"})," ",A.jsx("kbd",{children:"→"})," to step through trace"]})]})};Oe.displayName="CodeEditor";const Or=B.memo(Oe);export{Or as default};
